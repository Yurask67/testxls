#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
Упрощенная функция обновления графика отпусков 2026 года
Работает с текстовым представлением данных
"""

def show_current_structure():
    """
    Показывает текущую структуру файла графика отпусков
    """
    print("СТРУКТУРА ФАЙЛА 'график_отпусков_2026.xlsx':")
    print("=" * 50)
    print("Лист 1: 'График отпусков 2026'")
    print("  - Заголовок с календарем на 2026 год")
    print("  - Столбцы: №, ФИО, Должность, Отдел")
    print("  - Даты с января по декабрь 2026 года")
    print("  - Цветовая схема для типов дней")
    print()
    
    print("Лист 2: 'Сотрудники'")
    print("  - Данные сотрудников и периоды отпусков")
    print("  - Столбцы: №, ФИО, Должность, Отдел, Начало отпуска, Конец отпуска")
    print()
    
    print("Лист 3: 'Легенда'")
    print("  - Обозначения цветов и типов дней")
    print("  - Производственный календарь 2026 года")
    print()
    
    print("Лист 4: 'Праздники'")
    print("  - Перечень праздничных дней 2026 года")

def explain_update_function():
    """
    Объясняет, как работает функция обновления
    """
    print("\nФУНКЦИЯ ОБНОВЛЕНИЯ:")
    print("=" * 30)
    print()
    print("Функция обновления - это скрипт, который:")
    print("1. Читает данные с листа 'Сотрудники'")
    print("2. Переносит информацию о сотрудниках на лист 'График отпусков 2026'")
    print("3. Отмечает периоды отпусков в календаре цветом")
    print("4. Проверяет пересечения отпусков")
    print("5. Сохраняет изменения в новом файле")
    print()
    print("КАК РАБОТАЕТ АВТОМАТИЧЕСКОЕ ЗАПОЛНЕНИЕ:")
    print("- При заполнении дат отпусков на листе 'Сотрудники'")
    print("- Скрипт автоматически находит эти даты в календаре")
    print("- Отмечает соответствующие ячейки цветом")
    print("- Обновляет общее количество дней отпуска")
    print()
    print("ПОЧЕМУ НЕ РАБОТАЕТ АВТОМАТИЧЕСКОЕ ЗАПОЛНЕНИЕ:")
    print("1. Скрипт update_vacation_schedule.py не был запущен")
    print("2. Файл график_отпусков_2026.xlsx открыт в Excel")
    print("3. Не установлены необходимые библиотеки Python")
    print("4. Нет прав на запись в файл")

def manual_update_instructions():
    """
    Инструкции по ручному обновлению
    """
    print("\nИНСТРУКЦИИ ПО РУЧНОМУ ОБНОВЛЕНИЮ:")
    print("=" * 40)
    print()
    print("1. Закройте файл 'график_отпусков_2026.xlsx' в Excel")
    print("2. Откройте лист 'Сотрудники'")
    print("3. Внесите данные сотрудников и периоды отпусков")
    print("4. Откройте лист 'График отпусков 2026'")
    print("5. Вручную отметьте периоды отпусков в календаре")
    print("6. Используйте цвет зеленый для обозначения отпусков")
    print()
    print("ПОЛЕЗНЫЕ СОВЕТЫ:")
    print("- Используйте функцию 'Заливка' в Excel для отметки отпусков")
    print("- Проверяйте пересечения отпусков визуально")
    print("- Сохраняйте файл после каждого изменения")

def update_prazdniki_instructions():
    """
    Инструкции по обновлению праздничных дней
    """
    print("\nОБНОВЛЕНИЕ ПРАЗДНИЧНЫХ ДНЕЙ:")
    print("=" * 35)
    print()
    print("Если производственный календарь изменился:")
    print("1. Откройте лист 'Праздники'")
    print("2. Внесите изменения в список праздничных дней")
    print("3. Откройте лист 'Легенда'")
    print("4. Обновите информацию о праздничных днях")
    print("5. Пересчитайте рабочие дни в календаре")
    print()
    print("ВАЖНО:")
    print("- Изменение праздничных дней влияет на график отпусков")
    print("- Предпраздничные дни также нужно обновить")
    print("- После изменения календаря перепроверьте все отпуска")

def main():
    """
    Основная функция
    """
    print("ИНФОРМАЦИЯ О ФУНКЦИИ ОБНОВЛЕНИЯ ГРАФИКА ОТПУСКОВ")
    print("=" * 55)
    print()
    
    show_current_structure()
    explain_update_function()
    manual_update_instructions()
    update_prazdniki_instructions()
    
    print("\n" + "=" * 55)
    print("Для автоматического обновления необходимы:")
    print("1. Установленные библиотеки: pip install openpyxl")
    print("2. Закрытый файл график_отпусков_2026.xlsx")
    print("3. Запуск: python update_vacation_schedule.py")

if __name__ == "__main__":
    main()