#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
Создание графика отпусков на 2026 год
Упрощенная версия без использования внешних библиотек
"""

from datetime import datetime, timedelta

def get_2026_calendar():
    """Создает календарь на 2026 год"""
    
    # Праздничные дни 2026 года (ст. 112 ТК РФ)
    holidays = [
        "01.01.2026", "02.01.2026", "03.01.2026", "04.01.2026", 
        "05.01.2026", "06.01.2026", "07.01.2026", "08.01.2026",
        "23.02.2026", "08.03.2026", "01.05.2026", "09.05.2026",
        "12.06.2026", "04.11.2026"
    ]
    
    # Предпраздничные дни (сокращенный рабочий день)
    pre_holidays = [
        "20.02.2026", "07.03.2026", "08.05.2026", 
        "11.06.2026", "03.11.2026", "31.12.2026"
    ]
    
    return {
        "holidays": holidays,
        "pre_holidays": pre_holidays
    }

def get_days_in_month(year, month):
    """Возвращает количество дней в месяце"""
    if month in [1, 3, 5, 7, 8, 10, 12]:
        return 31
    elif month in [4, 6, 9, 11]:
        return 30
    elif month == 2:
        # Проверка на високосный год
        if year % 4 == 0 and (year % 100 != 0 or year % 400 == 0):
            return 29
        else:
            return 28
    return 30

def get_weekday_name(weekday):
    """Возвращает сокращенное название дня недели"""
    days = ["Пн", "Вт", "Ср", "Чт", "Пт", "Сб", "Вс"]
    return days[weekday]

def get_month_name(month):
    """Возвращает сокращенное название месяца"""
    months = {
        1: "Янв", 2: "Фев", 3: "Мар", 4: "Апр",
        5: "Май", 6: "Июн", 7: "Июл", 8: "Авг",
        9: "Сен", 10: "Окт", 11: "Ноя", 12: "Дек"
    }
    return months[month]

def create_calendar_header():
    """Создает заголовок календаря"""
    print("=" * 100)
    print("ГРАФИК ОТПУСКОВ НА 2026 ГОД")
    print("=" * 100)
    print()
    
    # Создаем заголовок с месяцами
    header = "№  | ФИО сотрудника           | Должность   | Отдел         | "
    
    # Добавляем месяцы
    for month in range(1, 13):
        month_name = get_month_name(month)
        # Каждый месяц занимает 3 позиции
        header += f"{month_name:>3} "
    
    print(header)
    print("-" * len(header))
    
    # Вторая строка с днями недели
    days_header = "   |                          |             |               | "
    for month in range(1, 13):
        # Для каждого месяца добавляем дни недели
        days_in_month = get_days_in_month(2026, month)
        for day in range(1, days_in_month + 1):
            date_obj = datetime(2026, month, day)
            weekday = date_obj.weekday()
            days_header += get_weekday_name(weekday)[0]  # Первая буква дня недели
    
    print(days_header)

def print_employee_vacation_form():
    """Печатает форму для ввода данных сотрудников"""
    print("\n")
    print("ЛИСТ 2: ДАННЫЕ СОТРУДНИКОВ И ПЕРИОДЫ ОТПУСКОВ")
    print("=" * 80)
    
    # Заголовки
    print("№  | ФИО сотрудника           | Должность   | Отдел         | Периоды отпусков")
    print("   |                          |             |               | Начало    | Конец")
    print("-" * 80)
    
    # Примеры сотрудников
    employees = [
        ["1", "Иванов Иван Иванович", "Менеджер", "Отдел продаж"],
        ["", "", "", "", "01.06.2026", "14.06.2026"],
        ["", "", "", "", "01.12.2026", "14.12.2026"],
        ["2", "Петров Петр Петрович", "Разработчик", "IT отдел"],
        ["", "", "", "", "15.07.2026", "28.07.2026"],
        ["", "", "", "", "15.01.2027", "28.01.2027"],
        ["3", "Сидорова Мария Владимировна", "Бухгалтер", "Бухгалтерия"],
        ["", "", "", "", "01.08.2026", "14.08.2026"],
        ["", "", "", "", "01.02.2027", "14.02.2027"],
    ]
    
    for emp in employees:
        if len(emp) == 4:  # Основная строка сотрудника
            print(f"{emp[0]:<3}| {emp[1]:<25}| {emp[2]:<12}| {emp[3]:<14}|")
        else:  # Строка с периодом отпуска
            print(f"   |                          |             |               | {emp[4]:<9} | {emp[5]}")

def print_legend():
    """Печатает легенду календаря"""
    print("\n")
    print("ЛЕГЕНДА")
    print("=" * 50)
    print("Обозначения в календаре:")
    print("Пн, Вт, Ср, Чт, Пт - Рабочие дни")
    print("Сб, Вс             - Выходные дни")
    print("*                  - Праздничные дни")
    print("o                  - Предпраздничные дни")
    print()
    
    # Производственный календарь
    calendar = get_2026_calendar()
    print("ПРАЗДНИЧНЫЕ ДНИ 2026:")
    for holiday in calendar["holidays"]:
        print(f"  {holiday}")
    
    print()
    print("ПРЕДПРАЗДНИЧНЫЕ ДНИ 2026:")
    for pre_holiday in calendar["pre_holidays"]:
        print(f"  {pre_holiday}")

def main():
    """Основная функция"""
    print("Создание графика отпусков на 2026 год")
    print("====================================")
    print()
    
    # Создаем заголовок календаря
    create_calendar_header()
    
    # Печатаем форму для сотрудников
    print_employee_vacation_form()
    
    # Печатаем легенду
    print_legend()
    
    print("\n")
    print("ИНСТРУКЦИЯ ПО ИСПОЛЬЗОВАНИЮ:")
    print("1. Внесите данные сотрудников в лист 'Сотрудники'")
    print("2. Укажите периоды отпусков для каждого сотрудника")
    print("3. Используйте цветовую схему для обозначения типов дней")
    print("4. Для автоматического заполнения календаря используйте Excel макрос")

if __name__ == "__main__":
    main()