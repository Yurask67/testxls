#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–ü–†–û–°–¢–û–ô –°–û–ó–î–ê–¢–ï–õ–¨ –ì–†–ê–§–ò–ö–ê –û–¢–ü–£–°–ö–û–í
–°–æ–∑–¥–∞–µ—Ç —á–∏—Å—Ç—ã–π Excel —Ñ–∞–π–ª + –ø—Ä–æ—Å—Ç–µ–π—à–∏–π —Ä–∞–±–æ—á–∏–π –º–∞–∫—Ä–æ—Å
"""

import os
from datetime import datetime
from openpyxl import Workbook
from openpyxl.styles import PatternFill, Font, Alignment, Border, Side
from openpyxl.utils import get_column_letter

def create_simple_vacation_file():
    """–°–æ–∑–¥–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–π Excel —Ñ–∞–π–ª"""
    
    print("=" * 70)
    print("–°–û–ó–î–ê–ù–ò–ï –ü–†–û–°–¢–û–ì–û –§–ê–ô–õ–ê –î–õ–Ø –û–¢–ü–£–°–ö–û–í")
    print("=" * 70)
    
    # 1. –°–û–ó–î–ê–ï–ú EXCEL –§–ê–ô–õ
    wb = Workbook()
    
    # –£–¥–∞–ª—è–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π –ª–∏—Å—Ç
    if "Sheet" in wb.sheetnames:
        default_sheet = wb["Sheet"]
        wb.remove(default_sheet)
    
    # 2. –°–û–ó–î–ê–ï–ú –õ–ò–°–¢ "–î–ê–ù–ù–´–ï" - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–π
    print("üìù –°–æ–∑–¥–∞—é –ª–∏—Å—Ç –î–ê–ù–ù–´–ï...")
    ws_data = wb.create_sheet(title="–î–ê–ù–ù–´–ï")
    
    # –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
    headers = ["‚Ññ", "–§–ò–û", "–ù–∞—á–∞–ª–æ", "–ö–æ–Ω–µ—Ü", "–î–Ω–µ–π"]
    for col, header in enumerate(headers, 1):
        cell = ws_data.cell(row=1, column=col, value=header)
        cell.font = Font(bold=True, color="FFFFFF")
        cell.fill = PatternFill(start_color="0070C0", fill_type="solid")
        cell.alignment = Alignment(horizontal="center")
    
    # –ü—Ä–æ—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ (—Ç–æ–ª—å–∫–æ 1 –æ—Ç–ø—É—Å–∫ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã)
    test_data = [
        [1, "–ò–í–ê–ù–û–í –ò–í–ê–ù –ò–í–ê–ù–û–í–ò–ß", "10.01.2026", "25.01.2026", ""],
        [2, "–ü–ï–¢–†–û–í –ü–ï–¢–† –ü–ï–¢–†–û–í–ò–ß", "15.02.2026", "25.02.2026", ""],
        [3, "–°–ò–î–û–†–û–í–ê –ú–ê–†–ò–Ø", "01.03.2026", "14.03.2026", ""]
    ]
    
    for row_idx, row_data in enumerate(test_data, start=2):
        for col_idx, value in enumerate(row_data, start=1):
            ws_data.cell(row=row_idx, column=col_idx, value=value)
    
    # –®–∏—Ä–∏–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤
    ws_data.column_dimensions['A'].width = 5
    ws_data.column_dimensions['B'].width = 25
    ws_data.column_dimensions['C'].width = 12
    ws_data.column_dimensions['D'].width = 12
    ws_data.column_dimensions['E'].width = 8
    
    # 3. –°–û–ó–î–ê–ï–ú –õ–ò–°–¢ "–ì–†–ê–§–ò–ö" - –ø—É—Å—Ç–æ–π
    print("üìä –°–æ–∑–¥–∞—é –ª–∏—Å—Ç –ì–†–ê–§–ò–ö...")
    ws_graph = wb.create_sheet(title="–ì–†–ê–§–ò–ö")
    
    # –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
    ws_graph['A1'] = "‚Ññ"
    ws_graph['B1'] = "–§–ò–û"
    
    for col in ['A', 'B']:
        cell = ws_graph[f'{col}1']
        cell.font = Font(bold=True, color="FFFFFF")
        cell.fill = PatternFill(start_color="0070C0", fill_type="solid")
        cell.alignment = Alignment(horizontal="center")
    
    ws_graph.column_dimensions['A'].width = 5
    ws_graph.column_dimensions['B'].width = 25
    
    # –î–æ–±–∞–≤–ª—è–µ–º –§–ò–û
    for i in range(2, 5):
        ws_graph.cell(row=i, column=1, value=i-1)
        ws_graph.cell(row=i, column=2, value=test_data[i-2][1])
    
    # 4. –°–û–ó–î–ê–ï–ú –Ø–ù–í–ê–†–¨ 2026 (—Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 10 –¥–Ω–µ–π –¥–ª—è —Ç–µ—Å—Ç–∞)
    print("üìÖ –î–æ–±–∞–≤–ª—è—é –∫–∞–ª–µ–Ω–¥–∞—Ä—å (—è–Ω–≤–∞—Ä—å 2026)...")
    
    # –ó–∞–≥–æ–ª–æ–≤–æ–∫ —è–Ω–≤–∞—Ä—è
    ws_graph.merge_cells('C1:L1')
    jan_cell = ws_graph['C1']
    jan_cell.value = "–Ø–ù–í–ê–†–¨ 2026"
    jan_cell.font = Font(bold=True, color="FFFFFF", size=12)
    jan_cell.fill = PatternFill(start_color="FF6600", fill_type="solid")
    jan_cell.alignment = Alignment(horizontal="center")
    
    # –î–Ω–∏ —è–Ω–≤–∞—Ä—è (1-10)
    for day in range(1, 11):
        col = get_column_letter(day + 2)  # C=3, D=4, ...
        
        # –î–µ–Ω—å –º–µ—Å—è—Ü–∞
        day_cell = ws_graph[f'{col}2']
        day_cell.value = day
        day_cell.font = Font(bold=True)
        day_cell.alignment = Alignment(horizontal="center")
        
        # –î–µ–Ω—å –Ω–µ–¥–µ–ª–∏
        weekday_cell = ws_graph[f'{col}3']
        # –ü—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏
        weekday_cell.value = ["–ü–Ω","–í—Ç","–°—Ä","–ß—Ç","–ü—Ç","–°–±","–í—Å"][(day - 1) % 7]
        weekday_cell.alignment = Alignment(horizontal="center")
        weekday_cell.font = Font(size=9)
        
        # –®–∏—Ä–∏–Ω–∞ —Å—Ç–æ–ª–±—Ü–∞
        ws_graph.column_dimensions[col].width = 5
    
    # 5. –°–û–ó–î–ê–ï–ú –û–ß–ï–ù–¨ –ü–†–û–°–¢–û–ô –ú–ê–ö–†–û–°
    print("‚öôÔ∏è –°–æ–∑–¥–∞—é –ø—Ä–æ—Å—Ç–æ–π –º–∞–∫—Ä–æ—Å...")
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ–π –º–∞–∫—Ä–æ—Å –±–µ–∑ —Å–ª–æ–∂–Ω–æ–≥–æ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
    simple_macro = '''Attribute VB_Name = "Module1"
' –û–ß–ï–ù–¨ –ü–†–û–°–¢–û–ô –ú–ê–ö–†–û–° –î–õ–Ø –û–¢–ü–£–°–ö–û–í
' –¢–û–õ–¨–ö–û –ë–ê–ó–û–í–´–ï –ö–û–ú–ê–ù–î–´

Sub –û–±–Ω–æ–≤–∏—Ç—å–ì—Ä–∞—Ñ–∏–∫()
    ' –ü—Ä–æ—Å—Ç–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ - –ø—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –º–∞–∫—Ä–æ—Å —Ä–∞–±–æ—Ç–∞–µ—Ç
    MsgBox "–ú–∞–∫—Ä–æ—Å –∑–∞–ø—É—â–µ–Ω! –°–µ–π—á–∞—Å –æ–±–Ω–æ–≤–ª—é –≥—Ä–∞—Ñ–∏–∫.", vbInformation
    
    ' –ü–æ–ª—É—á–∞–µ–º –ª–∏—Å—Ç—ã
    Dim –ª–∏—Å—Ç–î–∞–Ω–Ω—ã–µ As Worksheet
    Dim –ª–∏—Å—Ç–ì—Ä–∞—Ñ–∏–∫ As Worksheet
    
    Set –ª–∏—Å—Ç–î–∞–Ω–Ω—ã–µ = ThisWorkbook.Worksheets("–î–ê–ù–ù–´–ï")
    Set –ª–∏—Å—Ç–ì—Ä–∞—Ñ–∏–∫ = ThisWorkbook.Worksheets("–ì–†–ê–§–ò–ö")
    
    ' –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –≥—Ä–∞—Ñ–∏–∫–µ (—Å—Ç–æ–ª–±—Ü—ã C-L)
    –ª–∏—Å—Ç–ì—Ä–∞—Ñ–∏–∫.Range("C4:L10").ClearContents
    –ª–∏—Å—Ç–ì—Ä–∞—Ñ–∏–∫.Range("C4:L10").Interior.ColorIndex = xlNone
    
    ' –¶–≤–µ—Ç –¥–ª—è –æ—Ç–ø—É—Å–∫–∞
    Dim —Ü–≤–µ—Ç–û—Ç–ø—É—Å–∫–∞ As Long
    —Ü–≤–µ—Ç–û—Ç–ø—É—Å–∫–∞ = RGB(200, 255, 200) ' –°–≤–µ—Ç–ª–æ-–∑–µ–ª–µ–Ω—ã–π
    
    ' –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
    Dim —Å—Ç—Ä–æ–∫–∞ As Integer
    For —Å—Ç—Ä–æ–∫–∞ = 2 To 4 ' –¢–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 3 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
        ' –ü–æ–ª—É—á–∞–µ–º –¥–∞—Ç—ã
        Dim –¥–∞—Ç–∞–ù–∞—á–∞–ª–æ As Date
        Dim –¥–∞—Ç–∞–ö–æ–Ω–µ—Ü As Date
        
        On Error Resume Next ' –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –¥–∞—Ç
        –¥–∞—Ç–∞–ù–∞—á–∞–ª–æ = –ª–∏—Å—Ç–î–∞–Ω–Ω—ã–µ.Cells(—Å—Ç—Ä–æ–∫–∞, 3).Value
        –¥–∞—Ç–∞–ö–æ–Ω–µ—Ü = –ª–∏—Å—Ç–î–∞–Ω–Ω—ã–µ.Cells(—Å—Ç—Ä–æ–∫–∞, 4).Value
        On Error GoTo 0
        
        ' –ï—Å–ª–∏ –¥–∞—Ç—ã –≤–∞–ª–∏–¥–Ω—ã
        If IsDate(–¥–∞—Ç–∞–ù–∞—á–∞–ª–æ) And IsDate(–¥–∞—Ç–∞–ö–æ–Ω–µ—Ü) Then
            ' –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –¥–Ω–∏
            Dim –¥–Ω–∏–û—Ç–ø—É—Å–∫–∞ As Integer
            –¥–Ω–∏–û—Ç–ø—É—Å–∫–∞ = –¥–∞—Ç–∞–ö–æ–Ω–µ—Ü - –¥–∞—Ç–∞–ù–∞—á–∞–ª–æ + 1
            –ª–∏—Å—Ç–î–∞–Ω–Ω—ã–µ.Cells(—Å—Ç—Ä–æ–∫–∞, 5).Value = –¥–Ω–∏–û—Ç–ø—É—Å–∫–∞
            
            ' –û—Ç–º–µ—á–∞–µ–º –æ—Ç–ø—É—Å–∫ –≤ –≥—Ä–∞—Ñ–∏–∫–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è —è–Ω–≤–∞—Ä—è)
            If Month(–¥–∞—Ç–∞–ù–∞—á–∞–ª–æ) = 1 And Month(–¥–∞—Ç–∞–ö–æ–Ω–µ—Ü) = 1 Then
                Dim –¥–µ–Ω—å As Integer
                For –¥–µ–Ω—å = Day(–¥–∞—Ç–∞–ù–∞—á–∞–ª–æ) To Day(–¥–∞—Ç–∞–ö–æ–Ω–µ—Ü)
                    If –¥–µ–Ω—å <= 10 Then ' –¢–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 10 –¥–Ω–µ–π
                        Dim —Å—Ç–æ–ª–±–µ—Ü As Integer
                        —Å—Ç–æ–ª–±–µ—Ü = –¥–µ–Ω—å + 2 ' C=3 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–Ω—é 1
                        
                        With –ª–∏—Å—Ç–ì—Ä–∞—Ñ–∏–∫.Cells(—Å—Ç—Ä–æ–∫–∞ + 1, —Å—Ç–æ–ª–±–µ—Ü)
                            .Value = "–û"
                            .Interior.Color = —Ü–≤–µ—Ç–û—Ç–ø—É—Å–∫–∞
                            .Font.Bold = True
                            .HorizontalAlignment = xlCenter
                        End With
                    End If
                Next –¥–µ–Ω—å
            End If
        Else
            ' –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –¥–Ω–µ–π –µ—Å–ª–∏ –¥–∞—Ç—ã –Ω–µ–≤–∞–ª–∏–¥–Ω—ã
            –ª–∏—Å—Ç–î–∞–Ω–Ω—ã–µ.Cells(—Å—Ç—Ä–æ–∫–∞, 5).ClearContents
        End If
    Next —Å—Ç—Ä–æ–∫–∞
    
    ' –ü–æ–¥–≥–æ–Ω—è–µ–º —à–∏—Ä–∏–Ω—É —Å—Ç–æ–ª–±—Ü–æ–≤
    –ª–∏—Å—Ç–ì—Ä–∞—Ñ–∏–∫.Columns.AutoFit
    
    ' –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
    MsgBox "–ì—Ä–∞—Ñ–∏–∫ –æ–±–Ω–æ–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ!", vbInformation
End Sub

' –ï—â–µ –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞
Sub –¢–µ—Å—Ç()
    MsgBox "–¢–µ—Å—Ç–æ–≤—ã–π –º–∞–∫—Ä–æ—Å —Ä–∞–±–æ—Ç–∞–µ—Ç!", vbInformation
End Sub
'''
    
    # 6. –°–û–ó–î–ê–ï–ú –§–ê–ô–õ –° –ú–ê–ö–†–û–°–û–ú
    macro_filename = "–æ—Ç–ø—É—Å–∫_–º–∞–∫—Ä–æ—Å_–ø—Ä–æ—Å—Ç–æ–π.txt"
    with open(macro_filename, "w", encoding="utf-8") as f:
        f.write(simple_macro)
    
    # 7. –°–û–ó–î–ê–ï–ú –¢–ï–ö–°–¢–û–í–£–Æ –ò–ù–°–¢–†–£–ö–¶–ò–Æ
    create_instruction_file()
    
    # 8. –°–û–•–†–ê–ù–Ø–ï–ú EXCEL –§–ê–ô–õ
    excel_filename = "–æ—Ç–ø—É—Å–∫_–ø—Ä–æ—Å—Ç–æ–π.xlsx"
    wb.save(excel_filename)
    
    print(f"\n‚úÖ –§–ê–ô–õ–´ –°–û–ó–î–ê–ù–´:")
    print(f"   1. {excel_filename} - Excel —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏")
    print(f"   2. {macro_filename} - –ú–∞–∫—Ä–æ—Å –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è")
    print(f"   3. –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è.txt - –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è")
    
    print("\n" + "=" * 70)
    print("üìã –ö–†–ê–¢–ö–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø:")
    print("=" * 70)
    
    print("\n1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª: –æ—Ç–ø—É—Å–∫_–ø—Ä–æ—Å—Ç–æ–π.xlsx")
    print("2. –ù–∞–∂–º–∏—Ç–µ Alt+F11 (–æ—Ç–∫—Ä–æ–µ—Ç—Å—è —Ä–µ–¥–∞–∫—Ç–æ—Ä VBA)")
    print("3. –í –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ: Insert ‚Üí Module")
    print(f"4. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª: {macro_filename}")
    print("5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –í–ï–°–¨ —Ç–µ–∫—Å—Ç –∏–∑ —Ñ–∞–π–ª–∞")
    print("6. –í—Å—Ç–∞–≤—å—Ç–µ –≤ –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å –≤ VBA")
    print("7. –ó–∞–∫—Ä–æ–π—Ç–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä VBA (Alt+Q)")
    print("8. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ Excel, –Ω–∞–∂–º–∏—Ç–µ Alt+F8")
    print("9. –í—ã–±–µ—Ä–∏—Ç–µ '–û–±–Ω–æ–≤–∏—Ç—å–ì—Ä–∞—Ñ–∏–∫' ‚Üí –í—ã–ø–æ–ª–Ω–∏—Ç—å")
    
    return excel_filename

def create_instruction_file():
    """–°–æ–∑–¥–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—É—é —Ç–µ–∫—Å—Ç–æ–≤—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é"""
    
    instruction = """============================================
–ü–û–®–ê–ì–û–í–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø –î–û–ë–ê–í–õ–ï–ù–ò–Ø –ú–ê–ö–†–û–°–ê –í EXCEL
============================================

–®–ê–ì 1: –ü–û–î–ì–û–¢–û–í–ö–ê –§–ê–ô–õ–ê
----------------------
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç Python
2. –û–Ω —Å–æ–∑–¥–∞—Å—Ç 3 —Ñ–∞–π–ª–∞:
   - –æ—Ç–ø—É—Å–∫_–ø—Ä–æ—Å—Ç–æ–π.xlsx (Excel —Ñ–∞–π–ª)
   - –æ—Ç–ø—É—Å–∫_–º–∞–∫—Ä–æ—Å_–ø—Ä–æ—Å—Ç–æ–π.txt (–∫–æ–¥ –º–∞–∫—Ä–æ—Å–∞)
   - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è.txt (—ç—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è)

–®–ê–ì 2: –û–¢–ö–†–û–ô–¢–ï EXCEL –§–ê–ô–õ
-------------------------
1. –î–≤–∞–∂–¥—ã –∫–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ "–æ—Ç–ø—É—Å–∫_–ø—Ä–æ—Å—Ç–æ–π.xlsx"
2. –§–∞–π–ª –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ Excel
3. –í—ã —É–≤–∏–¥–∏—Ç–µ –¥–≤–∞ –ª–∏—Å—Ç–∞: "–î–ê–ù–ù–´–ï" –∏ "–ì–†–ê–§–ò–ö"

–®–ê–ì 3: –û–¢–ö–†–û–ô–¢–ï –†–ï–î–ê–ö–¢–û–† VBA
---------------------------
–í–ê–†–ò–ê–ù–¢ A (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
1. –ù–∞–∂–º–∏—Ç–µ ALT + F11 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
2. –û—Ç–∫—Ä–æ–µ—Ç—Å—è –æ–∫–Ω–æ Microsoft Visual Basic for Applications

–í–ê–†–ò–ê–ù–¢ B (–ï—Å–ª–∏ ALT+F11 –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç):
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É "–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫" –≤ Excel
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Visual Basic"

–ï—Å–ª–∏ –≤–∫–ª–∞–¥–∫–∏ "–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫" –Ω–µ—Ç:
1. –§–∞–π–ª ‚Üí –ü–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Üí –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–µ–Ω—Ç—É
2. –ü–æ—Å—Ç–∞–≤—å—Ç–µ –≥–∞–ª–æ—á–∫—É "–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫"
3. –ù–∞–∂–º–∏—Ç–µ OK

–®–ê–ì 4: –°–û–ó–î–ê–ô–¢–ï –ù–û–í–´–ô –ú–û–î–£–õ–¨
---------------------------
1. –í —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ VBA, –≤ –≤–µ—Ä—Ö–Ω–µ–º –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ:
   Insert (–í—Å—Ç–∞–≤–∫–∞) ‚Üí Module (–ú–æ–¥—É–ª—å)
2. –í –ª–µ–≤–æ–π –ø–∞–Ω–µ–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è "Modules" ‚Üí "Module1"
3. –ö–ª–∏–∫–Ω–∏—Ç–µ –¥–≤–∞–∂–¥—ã –Ω–∞ "Module1"

–®–ê–ì 5: –í–°–¢–ê–í–¨–¢–ï –ö–û–î –ú–ê–ö–†–û–°–ê
--------------------------
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª "–æ—Ç–ø—É—Å–∫_–º–∞–∫—Ä–æ—Å_–ø—Ä–æ—Å—Ç–æ–π.txt"
2. –í—ã–¥–µ–ª–∏—Ç–µ –í–ï–°–¨ —Ç–µ–∫—Å—Ç (Ctrl+A)
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ (Ctrl+C)
4. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä VBA
5. –í –ø—Ä–∞–≤–æ–π –ø–∞–Ω–µ–ª–∏ (–≥–¥–µ –º–∏–≥–∞–µ—Ç –∫—É—Ä—Å–æ—Ä) –≤—Å—Ç–∞–≤—å—Ç–µ –∫–æ–¥ (Ctrl+V)
6. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∫–æ–¥ –≤—Å—Ç–∞–≤–∏–ª—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é

–®–ê–ì 6: –°–û–•–†–ê–ù–ò–¢–ï –ò –í–ï–†–ù–ò–¢–ï–°–¨ –í EXCEL
-----------------------------------
1. –ó–∞–∫—Ä–æ–π—Ç–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä VBA (Alt+Q –∏–ª–∏ –∫—Ä–µ—Å—Ç–∏–∫)
2. –ò–ª–∏ –Ω–∞–∂–º–∏—Ç–µ Alt+Tab —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ Excel
3. Excel —Å–ø—Ä–æ—Å–∏—Ç: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è?"
4. –ù–∞–∂–º–∏—Ç–µ "–î–∞"
5. –ï—Å–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ .xlsm - —Å–æ–≥–ª–∞—Å–∏—Ç–µ—Å—å

–®–ê–ì 7: –ó–ê–ü–£–°–¢–ò–¢–ï –ú–ê–ö–†–û–°
----------------------
1. –í Excel –Ω–∞–∂–º–∏—Ç–µ ALT + F8
2. –ü–æ—è–≤–∏—Ç—Å—è –æ–∫–Ω–æ "–ú–∞–∫—Ä–æ—Å"
3. –í—ã–±–µ—Ä–∏—Ç–µ "–û–±–Ω–æ–≤–∏—Ç—å–ì—Ä–∞—Ñ–∏–∫" –∏–∑ —Å–ø–∏—Å–∫–∞
4. –ù–∞–∂–º–∏—Ç–µ "–í—ã–ø–æ–ª–Ω–∏—Ç—å"
5. –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "–ú–∞–∫—Ä–æ—Å –∑–∞–ø—É—â–µ–Ω!"

–®–ê–ì 8: –ü–†–û–í–ï–†–¨–¢–ï –†–ï–ó–£–õ–¨–¢–ê–¢
-------------------------
1. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –ª–∏—Å—Ç "–ì–†–ê–§–ò–ö"
2. –î–Ω–∏ –æ—Ç–ø—É—Å–∫–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç–º–µ—á–µ–Ω—ã –±—É–∫–≤–æ–π "–û"
3. –ù–∞ –ª–∏—Å—Ç–µ "–î–ê–ù–ù–´–ï" –≤ —Å—Ç–æ–ª–±—Ü–µ "–î–Ω–µ–π" –ø–æ—è–≤–∏—Ç—Å—è —á–∏—Å–ª–æ

============================================
–ß–ê–°–¢–´–ï –ü–†–û–ë–õ–ï–ú–´ –ò –†–ï–®–ï–ù–ò–Ø
============================================

–ü–†–û–ë–õ–ï–ú–ê 1: "–ù–µ —É–¥–∞–µ—Ç—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –º–∞–∫—Ä–æ—Å"
–†–ï–®–ï–ù–ò–ï:
1. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª –∫–∞–∫ .xlsm: –§–∞–π–ª ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫
2. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø: "–ö–Ω–∏–≥–∞ Excel —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º–∞–∫—Ä–æ—Å–æ–≤"
3. –ó–∞–∫—Ä–æ–π—Ç–µ –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –∑–∞–Ω–æ–≤–æ

–ü–†–û–ë–õ–ï–ú–ê 2: –ú–∞–∫—Ä–æ—Å –Ω–µ –≤–∏–¥–µ–Ω –≤ —Å–ø–∏—Å–∫–µ (Alt+F8)
–†–ï–®–ï–ù–ò–ï:
1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∫–æ–¥ –≤—Å—Ç–∞–≤–ª–µ–Ω –≤ Module1
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞: "Attribute VB_Name = "Module1""
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Excel

–ü–†–û–ë–õ–ï–ú–ê 3: –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞
–†–ï–®–ï–ù–ò–ï:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª–∏ –í–ï–°–¨ —Ç–µ–∫—Å—Ç –∏–∑ —Ñ–∞–π–ª–∞
2. –£–¥–∞–ª–∏—Ç–µ –º–æ–¥—É–ª—å –∏ —Å–æ–∑–¥–∞–π—Ç–µ –∑–∞–Ω–æ–≤–æ
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –µ—â–µ —Ä–∞–∑

–ü–†–û–ë–õ–ï–ú–ê 4: –†–µ–¥–∞–∫—Ç–æ—Ä VBA –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è (Alt+F11)
–†–ï–®–ï–ù–ò–ï:
1. –í Excel: –§–∞–π–ª ‚Üí –ü–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Üí –¶–µ–Ω—Ç—Ä —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é
2. –ù–∞–∂–º–∏—Ç–µ "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ü–µ–Ω—Ç—Ä–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é"
3. –í—ã–±–µ—Ä–∏—Ç–µ "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–∞–∫—Ä–æ—Å–æ–≤"
4. –í—ã–±–µ—Ä–∏—Ç–µ "–í–∫–ª—é—á–∏—Ç—å –≤—Å–µ –º–∞–∫—Ä–æ—Å—ã"
5. –ü–æ—Å—Ç–∞–≤—å—Ç–µ –≥–∞–ª–æ—á–∫—É "–î–æ–≤–µ—Ä—è—Ç—å –¥–æ—Å—Ç—É–ø –∫ –æ–±—ä–µ–∫—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏ VBA"

============================================
–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ú–ê–ö–†–û–°–ê
============================================

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ª–∏—Å—Ç "–î–ê–ù–ù–´–ï"
2. –ò–∑–º–µ–Ω–∏—Ç–µ –¥–∞—Ç—É –æ—Ç–ø—É—Å–∫–∞ —É –ò–≤–∞–Ω–æ–≤–∞:
   - –°—Ç—Ä–æ–∫–∞ 2, —Å—Ç–æ–ª–±–µ—Ü C: –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ "05.01.2026"
   - –°—Ç–æ–ª–±–µ—Ü D: –æ—Å—Ç–∞–≤—å—Ç–µ "25.01.2026"
3. –ù–∞–∂–º–∏—Ç–µ Alt+F8, –∑–∞–ø—É—Å—Ç–∏—Ç–µ –º–∞–∫—Ä–æ—Å "–û–±–Ω–æ–≤–∏—Ç—å–ì—Ä–∞—Ñ–∏–∫"
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –ª–∏—Å—Ç "–ì–†–ê–§–ò–ö"
5. –£ –ò–≤–∞–Ω–æ–≤–∞ –æ—Ç–ø—É—Å–∫ –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∞—Ç—å—Å—è —Å 5 —è–Ω–≤–∞—Ä—è

============================================
–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û
============================================

–ï—Å–ª–∏ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. –ú–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –Ω–∞ –ª–∏—Å—Ç "–î–ê–ù–ù–´–ï"
2. –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É 5, 6 –∏ —Ç.–¥.
3. –§–æ—Ä–º–∞—Ç: ‚Ññ, –§–ò–û, –ù–∞—á–∞–ª–æ, –ö–æ–Ω–µ—Ü, –î–Ω–µ–π
4. –í –º–∞–∫—Ä–æ—Å–µ –∏–∑–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫—É:
   For —Å—Ç—Ä–æ–∫–∞ = 2 To 10 ' –í–º–µ—Å—Ç–æ 4

–î–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è:
1. –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ —Å—Ç–æ–ª–±—Ü—ã –≤ –ª–∏—Å—Ç "–ì–†–ê–§–ò–ö"
2. –û–±–Ω–æ–≤–∏—Ç–µ –º–∞–∫—Ä–æ—Å (—Å—Ç—Ä–æ–∫–∞ —Å Range("C4:L10"))

–£–¥–∞—á–∏ –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏!
"""
    
    with open("–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è.txt", "w", encoding="utf-8") as f:
        f.write(instruction)

def main():
    try:
        print("\nüöÄ –ó–ê–ü–£–°–ö –°–û–ó–î–ê–ù–ò–Ø –ü–†–û–°–¢–û–ì–û –§–ê–ô–õ–ê...")
        create_simple_vacation_file()
        
        print("\n" + "=" * 70)
        print("‚úÖ –í–°–ï –ì–û–¢–û–í–û!")
        print("=" * 70)
        
        print("\nüìå –°–õ–ï–î–£–ô–¢–ï –ò–ù–°–¢–†–£–ö–¶–ò–ò –í –§–ê–ô–õ–ï '–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è.txt'")
        print("   –∏–ª–∏ –∫—Ä–∞—Ç–∫–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤—ã—à–µ.")
        
        input("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")
        
    except Exception as e:
        print(f"\n‚ùå –û—à–∏–±–∫–∞: {e}")
        import traceback
        traceback.print_exc()
        input("\n–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –≤—ã—Ö–æ–¥–∞...")

if __name__ == "__main__":
    main()